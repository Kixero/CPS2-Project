<!DOCTYPE html>
<html lang="en">
<head>
  <title>Arnaud Patra</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><!-- Add icon library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

  <style>
  .map {
    display: block;
    width: 60%;
    height: auto;
  }
  .overlay {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    height: 100%;
    width: 100%;
  }


  </style>
</head>
<body>

  <div class="container">
      <div class="options">
          <label>Radius </label><input type="range" id="radius" value="25" min="10" max="50" /><br />
          <label>Blur </label><input type="range" id="blur" value="15" min="10" max="50" />
      </div>
      <img src="Ressources/ITM-projetTech.png"  class="map"></img>
      <div class="overlay">
        <canvas id="canvas" width="1000" height="1000"></canvas>
      </div>
  </div>

  <script src="simpleheat/simpleheat.js"></script>
  <script src="data.js"></script>
  <script>

    //Doc on : https://www.cssscript.com/simple-heat-map-generator-with-javascript-and-canvas-simpleheat/
    //Library : https://github.com/mourner/simpleheat

    window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame ||
                                   window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;

    function get(id) {
        return document.getElementById(id);
    }

    var heat = simpleheat('canvas').data(data).max(18),
        frame;

    function draw() {
        console.time('draw');
        heat.draw();
        console.timeEnd('draw');
        frame = null;
    }

    draw();

    get('canvas').onclick = function (e) {
        heat.add([e.layerX, e.layerY, 10]);
        frame = frame || window.requestAnimationFrame(draw);
    };


    var radius = get('radius'),
        blur = get('blur'),
        changeType = 'oninput' in radius ? 'oninput' : 'onchange';

    radius[changeType] = blur[changeType] = function (e) {
        heat.radius(+radius.value, +blur.value);
        frame = frame || window.requestAnimationFrame(draw);
    };

    //Add random point every sec :
    //var t=setInterval(addPoint,1000);
    /*Adding point to heatmap*/
    /*
    function addPoint(){
      console.log('adding random point');
      var value = Math.floor(Math.random() * 20);
      var x = Math.floor(Math.random() * 600);
      var y = Math.floor(Math.random() * 1000);
      heat.add([x, y, value]);
      draw();
    }
    */

  </script>


</body>
</html>
